---
templates:
  - name: pmm_mongodb_replication_lag
    version: 1
    summary: MongoDB Replication Lag is high
    expr: |-
      max(mongodb_mongod_replset_member_replication_lag{state="SECONDARY", self=~"|1"}[1m]) by(cluster,name,set)
      > [[ .threshold ]]
    params:
      - name: threshold
        summary: Number of seconds
        type: float
        range: [0, 10000]
        value: 600
    for: 1m
    severity: warning
    annotations:
      summary: MongoDB Replication Lag is high for ({{ $labels.name }})
      description: |-
        MongoDB Replication Lag on {{ $labels.name }} (replicaSet {{ $labels.set }}) is above the defined threshold of [[ .threshold ]]secs. Current value is {{ $values.A }}secs.
