{
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "schemes": [
    "https",
    "http"
  ],
  "swagger": "2.0",
  "info": {
    "title": "PMM Server API",
    "version": "v1"
  },
  "paths": {
    "/v1/Settings/Change": {
      "post": {
        "tags": [
          "Server"
        ],
        "summary": "ChangeSettings changes PMM Server settings.",
        "operationId": "ChangeSettings",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "data_retention": {
                  "description": "A number of full days for Prometheus and QAN data retention. Should have a suffix in JSON: 2592000s, 43200m, 720h.",
                  "type": "string",
                  "x-order": 3
                },
                "disable_telemetry": {
                  "type": "boolean",
                  "format": "boolean",
                  "x-order": 1
                },
                "enable_telemetry": {
                  "type": "boolean",
                  "format": "boolean",
                  "x-order": 0
                },
                "metrics_resolutions": {
                  "description": "MetricsResolutions represents Prometheus exporters metrics resolutions.",
                  "type": "object",
                  "properties": {
                    "hr": {
                      "description": "High resolution. Should have a suffix in JSON: 1s, 1m, 1h.",
                      "type": "string",
                      "x-order": 0
                    },
                    "lr": {
                      "description": "Low resolution. Should have a suffix in JSON: 1s, 1m, 1h.",
                      "type": "string",
                      "x-order": 2
                    },
                    "mr": {
                      "description": "Medium resolution. Should have a suffix in JSON: 1s, 1m, 1h.",
                      "type": "string",
                      "x-order": 1
                    }
                  }
                },
                "ssh_key": {
                  "type": "string",
                  "x-order": 4
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {
                "settings": {
                  "description": "Settings represents PMM Server settings.",
                  "type": "object",
                  "properties": {
                    "aws_partitions": {
                      "description": "AWSPartitions valid AWS partitions.\n\n - AWS: \"aws\" AWS Standard partition.\n - AWS_CN: \"aws-cn\" AWS China partition.\n - AWS_US_GOV: \"aws-us-gov\" AWS GovCloud (US) partition.\n - AWS_ISO: \"aws-iso\" AWS ISO (US) partition.\n - AWS_ISO_B: \"aws-iso-b\" AWS ISOB (US) partition.",
                      "type": "string",
                      "default": "AWS_PARTITIONS_INVALID",
                      "enum": [
                        "AWS_PARTITIONS_INVALID",
                        "AWS",
                        "AWS_CN",
                        "AWS_US_GOV",
                        "AWS_ISO",
                        "AWS_ISO_B"
                      ]
                    },
                    "data_retention": {
                      "type": "string",
                      "x-order": 3
                    },
                    "metrics_resolutions": {
                      "description": "MetricsResolutions represents Prometheus exporters metrics resolutions.",
                      "type": "object",
                      "properties": {
                        "hr": {
                          "description": "High resolution. Should have a suffix in JSON: 1s, 1m, 1h.",
                          "type": "string",
                          "x-order": 0
                        },
                        "lr": {
                          "description": "Low resolution. Should have a suffix in JSON: 1s, 1m, 1h.",
                          "type": "string",
                          "x-order": 2
                        },
                        "mr": {
                          "description": "Medium resolution. Should have a suffix in JSON: 1s, 1m, 1h.",
                          "type": "string",
                          "x-order": 1
                        }
                      }
                    },
                    "ssh_key": {
                      "type": "string",
                      "x-order": 4
                    },
                    "telemetry_enabled": {
                      "type": "boolean",
                      "format": "boolean",
                      "x-order": 1
                    },
                    "updates_disabled": {
                      "type": "boolean",
                      "format": "boolean",
                      "x-order": 0
                    }
                  }
                }
              }
            }
          },
          "default": {
            "description": "An error response.",
            "schema": {
              "description": "ErrorResponse is a message returned on HTTP error.",
              "type": "object",
              "properties": {
                "code": {
                  "type": "integer",
                  "format": "int32"
                },
                "error": {
                  "type": "string"
                },
                "message": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/v1/Settings/Get": {
      "post": {
        "tags": [
          "Server"
        ],
        "summary": "GetSettings returns current PMM Server settings.",
        "operationId": "GetSettings",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {
                "settings": {
                  "description": "Settings represents PMM Server settings.",
                  "type": "object",
                  "properties": {
                    "aws_partitions": {
                      "description": "AWSPartitions valid AWS partitions.\n\n - AWS: \"aws\" AWS Standard partition.\n - AWS_CN: \"aws-cn\" AWS China partition.\n - AWS_US_GOV: \"aws-us-gov\" AWS GovCloud (US) partition.\n - AWS_ISO: \"aws-iso\" AWS ISO (US) partition.\n - AWS_ISO_B: \"aws-iso-b\" AWS ISOB (US) partition.",
                      "type": "string",
                      "default": "AWS_PARTITIONS_INVALID",
                      "enum": [
                        "AWS_PARTITIONS_INVALID",
                        "AWS",
                        "AWS_CN",
                        "AWS_US_GOV",
                        "AWS_ISO",
                        "AWS_ISO_B"
                      ]
                    },
                    "data_retention": {
                      "type": "string",
                      "x-order": 3
                    },
                    "metrics_resolutions": {
                      "description": "MetricsResolutions represents Prometheus exporters metrics resolutions.",
                      "type": "object",
                      "properties": {
                        "hr": {
                          "description": "High resolution. Should have a suffix in JSON: 1s, 1m, 1h.",
                          "type": "string",
                          "x-order": 0
                        },
                        "lr": {
                          "description": "Low resolution. Should have a suffix in JSON: 1s, 1m, 1h.",
                          "type": "string",
                          "x-order": 2
                        },
                        "mr": {
                          "description": "Medium resolution. Should have a suffix in JSON: 1s, 1m, 1h.",
                          "type": "string",
                          "x-order": 1
                        }
                      }
                    },
                    "ssh_key": {
                      "type": "string",
                      "x-order": 4
                    },
                    "telemetry_enabled": {
                      "type": "boolean",
                      "format": "boolean",
                      "x-order": 1
                    },
                    "updates_disabled": {
                      "type": "boolean",
                      "format": "boolean",
                      "x-order": 0
                    }
                  }
                }
              }
            }
          },
          "default": {
            "description": "An error response.",
            "schema": {
              "description": "ErrorResponse is a message returned on HTTP error.",
              "type": "object",
              "properties": {
                "code": {
                  "type": "integer",
                  "format": "int32"
                },
                "error": {
                  "type": "string"
                },
                "message": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/v1/Updates/Check": {
      "post": {
        "tags": [
          "Server"
        ],
        "summary": "CheckUpdates checks PMM Server updates availability.",
        "operationId": "CheckUpdates",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "force": {
                  "description": "If false, cached information may be returned.",
                  "type": "boolean",
                  "format": "boolean",
                  "x-order": 0
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {
                "installed": {
                  "description": "VersionInfo describes component version, or PMM Server as a whole.",
                  "type": "object",
                  "properties": {
                    "full_version": {
                      "description": "Full version for debugging.",
                      "type": "string",
                      "x-order": 1
                    },
                    "timestamp": {
                      "description": "Build or release date.",
                      "type": "string",
                      "format": "date-time",
                      "x-order": 2
                    },
                    "version": {
                      "description": "User-visible version.",
                      "type": "string",
                      "x-order": 0
                    }
                  }
                },
                "last_check": {
                  "description": "Last check time.",
                  "type": "string",
                  "format": "date-time",
                  "x-order": 4
                },
                "latest": {
                  "description": "VersionInfo describes component version, or PMM Server as a whole.",
                  "type": "object",
                  "properties": {
                    "full_version": {
                      "description": "Full version for debugging.",
                      "type": "string",
                      "x-order": 1
                    },
                    "timestamp": {
                      "description": "Build or release date.",
                      "type": "string",
                      "format": "date-time",
                      "x-order": 2
                    },
                    "version": {
                      "description": "User-visible version.",
                      "type": "string",
                      "x-order": 0
                    }
                  }
                },
                "latest_news_url": {
                  "description": "Latest available PMM Server release announcement URL.",
                  "type": "string",
                  "x-order": 3
                },
                "update_available": {
                  "description": "True if there is a PMM Server update available.",
                  "type": "boolean",
                  "format": "boolean",
                  "x-order": 2
                }
              }
            }
          },
          "default": {
            "description": "An error response.",
            "schema": {
              "description": "ErrorResponse is a message returned on HTTP error.",
              "type": "object",
              "properties": {
                "code": {
                  "type": "integer",
                  "format": "int32"
                },
                "error": {
                  "type": "string"
                },
                "message": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/v1/Updates/Start": {
      "post": {
        "tags": [
          "Server"
        ],
        "summary": "StartUpdate starts PMM Server update.",
        "operationId": "StartUpdate",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {
                "auth_token": {
                  "description": "Authentication token for getting update statuses.",
                  "type": "string",
                  "x-order": 0
                },
                "log_offset": {
                  "description": "Progress log offset.",
                  "type": "integer",
                  "format": "int64",
                  "x-order": 1
                }
              }
            }
          },
          "default": {
            "description": "An error response.",
            "schema": {
              "description": "ErrorResponse is a message returned on HTTP error.",
              "type": "object",
              "properties": {
                "code": {
                  "type": "integer",
                  "format": "int32"
                },
                "error": {
                  "type": "string"
                },
                "message": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/v1/Updates/Status": {
      "post": {
        "tags": [
          "Server"
        ],
        "summary": "UpdateStatus returns PMM Server update status.",
        "operationId": "UpdateStatus",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "auth_token": {
                  "description": "Authentication token.",
                  "type": "string",
                  "x-order": 0
                },
                "log_offset": {
                  "description": "Progress log offset.",
                  "type": "integer",
                  "format": "int64",
                  "x-order": 1
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {
                "done": {
                  "description": "True when update is done.",
                  "type": "boolean",
                  "format": "boolean",
                  "x-order": 2
                },
                "log_lines": {
                  "description": "Progress log lines.",
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "x-order": 0
                },
                "log_offset": {
                  "description": "Progress log offset for the next request.",
                  "type": "integer",
                  "format": "int64",
                  "x-order": 1
                }
              }
            }
          },
          "default": {
            "description": "An error response.",
            "schema": {
              "description": "ErrorResponse is a message returned on HTTP error.",
              "type": "object",
              "properties": {
                "code": {
                  "type": "integer",
                  "format": "int32"
                },
                "error": {
                  "type": "string"
                },
                "message": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/v1/readyz": {
      "get": {
        "tags": [
          "Server"
        ],
        "summary": "Readiness returns an error when some PMM Server component is not ready yet or is being restarted.\nIt can be used as for Docker health check or Kubernetes readiness probe.",
        "operationId": "Readiness",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object"
            }
          },
          "default": {
            "description": "An error response.",
            "schema": {
              "description": "ErrorResponse is a message returned on HTTP error.",
              "type": "object",
              "properties": {
                "code": {
                  "type": "integer",
                  "format": "int32"
                },
                "error": {
                  "type": "string"
                },
                "message": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/v1/version": {
      "get": {
        "tags": [
          "Server"
        ],
        "summary": "Version returns PMM Server versions.",
        "operationId": "Version",
        "parameters": [
          {
            "type": "string",
            "description": "Dummy parameter for internal testing. Do not use.",
            "name": "dummy",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "type": "object",
              "properties": {
                "managed": {
                  "description": "VersionInfo describes component version, or PMM Server as a whole.",
                  "type": "object",
                  "properties": {
                    "full_version": {
                      "description": "Full version for debugging.",
                      "type": "string",
                      "x-order": 1
                    },
                    "timestamp": {
                      "description": "Build or release date.",
                      "type": "string",
                      "format": "date-time",
                      "x-order": 2
                    },
                    "version": {
                      "description": "User-visible version.",
                      "type": "string",
                      "x-order": 0
                    }
                  }
                },
                "server": {
                  "description": "VersionInfo describes component version, or PMM Server as a whole.",
                  "type": "object",
                  "properties": {
                    "full_version": {
                      "description": "Full version for debugging.",
                      "type": "string",
                      "x-order": 1
                    },
                    "timestamp": {
                      "description": "Build or release date.",
                      "type": "string",
                      "format": "date-time",
                      "x-order": 2
                    },
                    "version": {
                      "description": "User-visible version.",
                      "type": "string",
                      "x-order": 0
                    }
                  }
                },
                "version": {
                  "description": "PMM Server version.",
                  "type": "string",
                  "x-order": 0
                }
              }
            }
          },
          "default": {
            "description": "An error response.",
            "schema": {
              "description": "ErrorResponse is a message returned on HTTP error.",
              "type": "object",
              "properties": {
                "code": {
                  "type": "integer",
                  "format": "int32"
                },
                "error": {
                  "type": "string"
                },
                "message": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    }
  }
}