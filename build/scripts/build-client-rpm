#!/bin/bash

. "$(dirname "$0")/vars"

main() {
  echo -----------------------------------------
  echo "Building PMM Client RPM packages..."
  echo -----------------------------------------

  local IMAGE=${1:-${rpmbuild_docker_image}}
  docker run --rm \
    --platform="${platform}" \
    -v "${bin_dir}":/home/builder/bin \
    -v "${build_dir}":/home/builder/build \
    -w /home/builder/build \
    -e PMM_VERSION="${pmm_version}" \
    -e PMM_RELEASE="${pmm_release}" \
    --entrypoint="/home/builder/bin/build-client-entrypoint" \
    "${IMAGE}" --build_rpm
}

main "$*"

# vim: expandtab shiftwidth=2 tabstop=2
